import{h as le}from"./has-cors.150b278c.js";import{b as x}from"./engine.io-parser.2ae49814.js";import{c as M}from"./component-emitter.72d4fec7.js";import{p as U}from"./parseqs.ede9f166.js";import{c as A}from"./component-inherit.7edfe7ae.js";import{y as re}from"./yeast.d32d0463.js";import{g as fe}from"./after.f5f6eafa.js";import{i as de}from"./indexof.a4b72e6b.js";import{p as ye}from"./parseuri.1963fa84.js";var me={exports:{}},L={},z=function(){return typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),ge=le.exports,ve=z,W=function(e){var t=e.xdomain,r=e.xscheme,i=e.enablesXDR;try{if(typeof XMLHttpRequest<"u"&&(!t||ge))return new XMLHttpRequest}catch{}try{if(typeof XDomainRequest<"u"&&!r&&i)return new XDomainRequest}catch{}if(!t)try{return new ve[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}},_={exports:{}},$,Q;function I(){if(Q)return $;Q=1;var e=x,t=M.exports;$=r;function r(i){this.path=i.path,this.hostname=i.hostname,this.port=i.port,this.secure=i.secure,this.query=i.query,this.timestampParam=i.timestampParam,this.timestampRequests=i.timestampRequests,this.readyState="",this.agent=i.agent||!1,this.socket=i.socket,this.enablesXDR=i.enablesXDR,this.withCredentials=i.withCredentials,this.pfx=i.pfx,this.key=i.key,this.passphrase=i.passphrase,this.cert=i.cert,this.ca=i.ca,this.ciphers=i.ciphers,this.rejectUnauthorized=i.rejectUnauthorized,this.forceNode=i.forceNode,this.isReactNative=i.isReactNative,this.extraHeaders=i.extraHeaders,this.localAddress=i.localAddress}return t(r.prototype),r.prototype.onError=function(i,n){var p=new Error(i);return p.type="TransportError",p.description=n,this.emit("error",p),this},r.prototype.open=function(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this},r.prototype.send=function(i){if(this.readyState==="open")this.write(i);else throw new Error("Transport not open")},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(i){var n=e.decodePacket(i,this.socket.binaryType);this.onPacket(n)},r.prototype.onPacket=function(i){this.emit("packet",i)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")},$}var k={exports:{}},j={exports:{}},F=1e3,q=F*60,B=q*60,E=B*24,Ce=E*365.25,be=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return we(e);if(r==="number"&&isNaN(e)===!1)return t.long?xe(e):ke(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function we(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*Ce;case"days":case"day":case"d":return r*E;case"hours":case"hour":case"hrs":case"hr":case"h":return r*B;case"minutes":case"minute":case"mins":case"min":case"m":return r*q;case"seconds":case"second":case"secs":case"sec":case"s":return r*F;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function ke(e){return e>=E?Math.round(e/E)+"d":e>=B?Math.round(e/B)+"h":e>=q?Math.round(e/q)+"m":e>=F?Math.round(e/F)+"s":e+"ms"}function xe(e){return N(e,E,"day")||N(e,B,"hour")||N(e,q,"minute")||N(e,F,"second")||e+" ms"}function N(e,t,r){if(!(e<t))return e<t*1.5?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}(function(e,t){t=e.exports=i.debug=i.default=i,t.coerce=c,t.disable=u,t.enable=p,t.enabled=y,t.humanize=be,t.instances=[],t.names=[],t.skips=[],t.formatters={};function r(s){var o=0,h;for(h in s)o=(o<<5)-o+s.charCodeAt(h),o|=0;return t.colors[Math.abs(o)%t.colors.length]}function i(s){var o;function h(){if(!!h.enabled){var d=h,m=+new Date,he=m-(o||m);d.diff=he,d.prev=o,d.curr=m,o=m;for(var g=new Array(arguments.length),R=0;R<g.length;R++)g[R]=arguments[R];g[0]=t.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var P=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(D,ue){if(D==="%%")return D;P++;var K=t.formatters[ue];if(typeof K=="function"){var pe=g[P];D=K.call(d,pe),g.splice(P,1),P--}return D}),t.formatArgs.call(d,g);var ce=h.log||t.log||console.log.bind(console);ce.apply(d,g)}}return h.namespace=s,h.enabled=t.enabled(s),h.useColors=t.useColors(),h.color=r(s),h.destroy=n,typeof t.init=="function"&&t.init(h),t.instances.push(h),h}function n(){var s=t.instances.indexOf(this);return s!==-1?(t.instances.splice(s,1),!0):!1}function p(s){t.save(s),t.names=[],t.skips=[];var o,h=(typeof s=="string"?s:"").split(/[\s,]+/),d=h.length;for(o=0;o<d;o++)!h[o]||(s=h[o].replace(/\*/g,".*?"),s[0]==="-"?t.skips.push(new RegExp("^"+s.substr(1)+"$")):t.names.push(new RegExp("^"+s+"$")));for(o=0;o<t.instances.length;o++){var m=t.instances[o];m.enabled=t.enabled(m.namespace)}}function u(){t.enable("")}function y(s){if(s[s.length-1]==="*")return!0;var o,h;for(o=0,h=t.skips.length;o<h;o++)if(t.skips[o].test(s))return!1;for(o=0,h=t.names.length;o<h;o++)if(t.names[o].test(s))return!0;return!1}function c(s){return s instanceof Error?s.stack||s.message:s}})(j,j.exports);(function(e,t){t=e.exports=j.exports,t.log=n,t.formatArgs=i,t.save=p,t.load=u,t.useColors=r,t.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:y(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(c){try{return JSON.stringify(c)}catch(s){return"[UnexpectedJSONParseError]: "+s.message}};function i(c){var s=this.useColors;if(c[0]=(s?"%c":"")+this.namespace+(s?" %c":" ")+c[0]+(s?"%c ":" ")+"+"+t.humanize(this.diff),!!s){var o="color: "+this.color;c.splice(1,0,o,"color: inherit");var h=0,d=0;c[0].replace(/%[a-zA-Z%]/g,function(m){m!=="%%"&&(h++,m==="%c"&&(d=h))}),c.splice(d,0,o)}}function n(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function p(c){try{c==null?t.storage.removeItem("debug"):t.storage.debug=c}catch{}}function u(){var c;try{c=t.storage.debug}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}t.enable(u());function y(){try{return window.localStorage}catch{}}})(k,k.exports);var ie=I(),Te=U,se=x,Se=A,Fe=re,C=k.exports("engine.io-client:polling"),ne=b,qe=function(){var e=W,t=new e({xdomain:!1});return t.responseType!=null}();function b(e){var t=e&&e.forceBase64;(!qe||t)&&(this.supportsBinary=!1),ie.call(this,e)}Se(b,ie);b.prototype.name="polling";b.prototype.doOpen=function(){this.poll()};b.prototype.pause=function(e){var t=this;this.readyState="pausing";function r(){C("paused"),t.readyState="paused",e()}if(this.polling||!this.writable){var i=0;this.polling&&(C("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){C("pre-pause polling complete"),--i||r()})),this.writable||(C("we are currently writing - waiting to pause"),i++,this.once("drain",function(){C("pre-pause writing complete"),--i||r()}))}else r()};b.prototype.poll=function(){C("polling"),this.polling=!0,this.doPoll(),this.emit("poll")};b.prototype.onData=function(e){var t=this;C("polling got data %s",e);var r=function(i,n,p){if(t.readyState==="opening"&&i.type==="open"&&t.onOpen(),i.type==="close")return t.onClose(),!1;t.onPacket(i)};se.decodePayload(e,this.socket.binaryType,r),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():C('ignoring poll - transport state "%s"',this.readyState))};b.prototype.doClose=function(){var e=this;function t(){C("writing close packet"),e.write([{type:"close"}])}this.readyState==="open"?(C("transport open - closing"),t()):(C("transport not open - deferring close"),this.once("open",t))};b.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};se.encodePayload(e,this.supportsBinary,function(i){t.doWrite(i,r)})};b.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";this.timestampRequests!==!1&&(e[this.timestampParam]=Fe()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=Te.encode(e),this.port&&(t==="https"&&Number(this.port)!==443||t==="http"&&Number(this.port)!==80)&&(r=":"+this.port),e.length&&(e="?"+e);var i=this.hostname.indexOf(":")!==-1;return t+"://"+(i?"["+this.hostname+"]":this.hostname)+r+this.path+e};var Be=W,oe=ne,Ee=M.exports,Re=A,X=k.exports("engine.io-client:polling-xhr"),Pe=z;_.exports=T;_.exports.Request=f;function V(){}function T(e){if(oe.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,typeof location<"u"){var t=location.protocol==="https:",r=location.port;r||(r=t?443:80),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}Re(T,oe);T.prototype.supportsBinary=!0;T.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new f(e)};T.prototype.doWrite=function(e,t){var r=typeof e!="string"&&e!==void 0,i=this.request({method:"POST",data:e,isBinary:r}),n=this;i.on("success",t),i.on("error",function(p){n.onError("xhr post error",p)}),this.sendXhr=i};T.prototype.doPoll=function(){X("xhr poll");var e=this.request(),t=this;e.on("data",function(r){t.onData(r)}),e.on("error",function(r){t.onError("xhr poll error",r)}),this.pollXhr=e};function f(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=e.async!==!1,this.data=e.data!==void 0?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}Ee(f.prototype);f.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new Be(e),r=this;try{X("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}}catch{}if(this.method==="POST")try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{t.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(t.readyState===2)try{var n=t.getResponseHeader("Content-Type");(r.supportsBinary&&n==="application/octet-stream"||n==="application/octet-stream; charset=UTF-8")&&(t.responseType="arraybuffer")}catch{}t.readyState===4&&(t.status===200||t.status===1223?r.onLoad():setTimeout(function(){r.onError(typeof t.status=="number"?t.status:0)},0))},X("xhr data %s",this.data),t.send(this.data)}catch(n){setTimeout(function(){r.onError(n)},0);return}typeof document<"u"&&(this.index=f.requestsCount++,f.requests[this.index]=this)};f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()};f.prototype.onData=function(e){this.emit("data",e),this.onSuccess()};f.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)};f.prototype.cleanup=function(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=V:this.xhr.onreadystatechange=V,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete f.requests[this.index],this.xhr=null}};f.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch{}t==="application/octet-stream"||t==="application/octet-stream; charset=UTF-8"?e=this.xhr.response||this.xhr.responseText:e=this.xhr.responseText}catch(r){this.onError(r)}e!=null&&this.onData(e)};f.prototype.hasXDR=function(){return typeof XDomainRequest<"u"&&!this.xs&&this.enablesXDR};f.prototype.abort=function(){this.cleanup()};f.requestsCount=0;f.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Y);else if(typeof addEventListener=="function"){var De="onpagehide"in Pe?"pagehide":"unload";addEventListener(De,Y,!1)}}function Y(){for(var e in f.requests)f.requests.hasOwnProperty(e)&&f.requests[e].abort()}var J=ne,Ne=A,ee=z,He=S,Oe=/\n/g,Ae=/\\n/g,H;function Le(){}function S(e){J.call(this,e),this.query=this.query||{},H||(H=ee.___eio=ee.___eio||[]),this.index=H.length;var t=this;H.push(function(r){t.onData(r)}),this.query.j=this.index,typeof addEventListener=="function"&&addEventListener("beforeunload",function(){t.script&&(t.script.onerror=Le)},!1)}Ne(S,J);S.prototype.supportsBinary=!1;S.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),J.prototype.doClose.call(this)};S.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(n){e.onError("jsonp poll error",n)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t;var i=typeof navigator<"u"&&/gecko/i.test(navigator.userAgent);i&&setTimeout(function(){var n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)};S.prototype.doWrite=function(e,t){var r=this;if(!this.form){var i=document.createElement("form"),n=document.createElement("textarea"),p=this.iframeId="eio_iframe_"+this.index,u;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=p,i.method="POST",i.setAttribute("accept-charset","utf-8"),n.name="d",i.appendChild(n),document.body.appendChild(i),this.form=i,this.area=n}this.form.action=this.uri();function y(){c(),t()}function c(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(o){r.onError("jsonp polling iframe removal error",o)}try{var s='<iframe src="javascript:0" name="'+r.iframeId+'">';u=document.createElement(s)}catch{u=document.createElement("iframe"),u.name=r.iframeId,u.src="javascript:0"}u.id=r.iframeId,r.form.appendChild(u),r.iframe=u}c(),e=e.replace(Ae,`\\
`),this.area.value=e.replace(Oe,"\\n");try{this.form.submit()}catch{}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){r.iframe.readyState==="complete"&&y()}:this.iframe.onload=y};const $e={},je=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"})),Xe=fe(je);var G=I(),Me=x,Ue=U,ze=A,We=re,_e=k.exports("engine.io-client:websocket"),O,Z;typeof WebSocket<"u"?O=WebSocket:typeof self<"u"&&(O=self.WebSocket||self.MozWebSocket);if(typeof window>"u")try{Z=Xe}catch{}var w=O||Z,Ie=v;function v(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=O&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(w=Z),G.call(this,e)}ze(v,G);v.prototype.name="websocket";v.prototype.supportsBinary=!0;v.prototype.doOpen=function(){if(!!this.check()){var e=this.uri(),t=this.protocols,r={};this.isReactNative||(r.agent=this.agent,r.perMessageDeflate=this.perMessageDeflate,r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new w(e,t):new w(e):new w(e,t,r)}catch(i){return this.emit("error",i)}this.ws.binaryType===void 0&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}};v.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}};v.prototype.write=function(e){var t=this;this.writable=!1;for(var r=e.length,i=0,n=r;i<n;i++)(function(u){Me.encodePacket(u,t.supportsBinary,function(y){if(!t.usingBrowserWebSocket){var c={};if(u.options&&(c.compress=u.options.compress),t.perMessageDeflate){var s=typeof y=="string"?Buffer.byteLength(y):y.length;s<t.perMessageDeflate.threshold&&(c.compress=!1)}}try{t.usingBrowserWebSocket?t.ws.send(y):t.ws.send(y,c)}catch{_e("websocket closed before onclose event")}--r||p()})})(e[i]);function p(){t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0)}};v.prototype.onClose=function(){G.prototype.onClose.call(this)};v.prototype.doClose=function(){typeof this.ws<"u"&&this.ws.close()};v.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";this.port&&(t==="wss"&&Number(this.port)!==443||t==="ws"&&Number(this.port)!==80)&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=We()),this.supportsBinary||(e.b64=1),e=Ue.encode(e),e.length&&(e="?"+e);var i=this.hostname.indexOf(":")!==-1;return t+"://"+(i?"["+this.hostname+"]":this.hostname)+r+this.path+e};v.prototype.check=function(){return!!w&&!("__initialize"in w&&this.name===v.prototype.name)};var Je=W,Ge=_.exports,Ze=He,Ke=Ie;L.polling=Qe;L.websocket=Ke;function Qe(e){var t,r=!1,i=!1,n=e.jsonp!==!1;if(typeof location<"u"){var p=location.protocol==="https:",u=location.port;u||(u=p?443:80),r=e.hostname!==location.hostname||u!==e.port,i=e.secure!==p}if(e.xdomain=r,e.xscheme=i,t=new Je(e),"open"in t&&!e.forceJSONP)return new Ge(e);if(!n)throw new Error("JSONP disabled");return new Ze(e)}var Ve=L,Ye=M.exports,l=k.exports("engine.io-client:socket"),et=de,ae=x,te=ye,tt=U,rt=a;function a(e,t){if(!(this instanceof a))return new a(e,t);t=t||{},e&&typeof e=="object"&&(t=e,e=null),e?(e=te(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=te(t.host).host),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?443:80),this.query=t.query||{},typeof this.query=="string"&&(this.query=tt.decode(this.query)),this.upgrade=t.upgrade!==!1,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=t.jsonp!==!1,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=t.withCredentials!==!1,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=t.perMessageDeflate!==!1?t.perMessageDeflate||{}:!1,this.perMessageDeflate===!0&&(this.perMessageDeflate={}),this.perMessageDeflate&&this.perMessageDeflate.threshold==null&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=t.rejectUnauthorized===void 0?!0:t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",(typeof self>"u"||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}a.priorWebsocketSuccess=!1;Ye(a.prototype);a.protocol=ae.protocol;a.Socket=a;a.Transport=I();a.transports=L;a.parser=x;a.prototype.createTransport=function(e){l('creating transport "%s"',e);var t=it(this.query);t.EIO=ae.protocol,t.transport=e;var r=this.transportOptions[e]||{};this.id&&(t.sid=this.id);var i=new Ve[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,withCredentials:r.withCredentials||this.withCredentials,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative});return i};function it(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}a.prototype.open=function(){var e;if(this.rememberUpgrade&&a.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){var t=this;setTimeout(function(){t.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)};a.prototype.setTransport=function(e){l("setting transport %s",e.name);var t=this;this.transport&&(l("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(r){t.onPacket(r)}).on("error",function(r){t.onError(r)}).on("close",function(){t.onClose("transport close")})};a.prototype.probe=function(e){l('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,i=this;a.priorWebsocketSuccess=!1;function n(){if(i.onlyBinaryUpgrades){var h=!this.supportsBinary&&i.transport.supportsBinary;r=r||h}r||(l('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(d){if(!r)if(d.type==="pong"&&d.data==="probe"){if(l('probe transport "%s" pong',e),i.upgrading=!0,i.emit("upgrading",t),!t)return;a.priorWebsocketSuccess=t.name==="websocket",l('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){r||i.readyState!=="closed"&&(l("changing transport and sending upgrade packet"),o(),i.setTransport(t),t.send([{type:"upgrade"}]),i.emit("upgrade",t),t=null,i.upgrading=!1,i.flush())})}else{l('probe transport "%s" failed',e);var m=new Error("probe error");m.transport=t.name,i.emit("upgradeError",m)}}))}function p(){r||(r=!0,o(),t.close(),t=null)}function u(h){var d=new Error("probe error: "+h);d.transport=t.name,p(),l('probe transport "%s" failed because of error: %s',e,h),i.emit("upgradeError",d)}function y(){u("transport closed")}function c(){u("socket closed")}function s(h){t&&h.name!==t.name&&(l('"%s" works - aborting "%s"',h.name,t.name),p())}function o(){t.removeListener("open",n),t.removeListener("error",u),t.removeListener("close",y),i.removeListener("close",c),i.removeListener("upgrading",s)}t.once("open",n),t.once("error",u),t.once("close",y),this.once("close",c),this.once("upgrading",s),t.open()};a.prototype.onOpen=function(){if(l("socket open"),this.readyState="open",a.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.upgrade&&this.transport.pause){l("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}};a.prototype.onPacket=function(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(l('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else l('packet received with socket readyState "%s"',this.readyState)};a.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};a.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){t.readyState!=="closed"&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)};a.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){l("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)};a.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})};a.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()};a.prototype.flush=function(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(l("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};a.prototype.write=a.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this};a.prototype.sendPacket=function(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),!(this.readyState==="closing"||this.readyState==="closed")){r=r||{},r.compress=r.compress!==!1;var n={type:e,data:t,options:r};this.emit("packetCreate",n),this.writeBuffer.push(n),i&&this.once("flush",i),this.flush()}};a.prototype.close=function(){if(this.readyState==="opening"||this.readyState==="open"){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}function t(){e.onClose("forced close"),l("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function i(){e.once("upgrade",r),e.once("upgradeError",r)}return this};a.prototype.onError=function(e){l("socket error %j",e),a.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)};a.prototype.onClose=function(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){l('socket close with reason: "%s"',e);var r=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),r.writeBuffer=[],r.prevBufferLen=0}};a.prototype.filterUpgrades=function(e){for(var t=[],r=0,i=e.length;r<i;r++)~et(this.transports,e[r])&&t.push(e[r]);return t};(function(e){e.exports=rt,e.exports.parser=x})(me);export{me as l};
