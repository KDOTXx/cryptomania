import{h as V}from"./has-binary2.8a78c161.js";import{a as W}from"./arraybuffer.slice.9c094f68.js";import{a as G}from"./after.f5f6eafa.js";import{r as K}from"./base64-arraybuffer.8e0339d2.js";import{r as M}from"./blob.387277be.js";var Q={},X=Object.keys||function(o){var l=[],h=Object.prototype.hasOwnProperty;for(var y in o)h.call(o,y)&&l.push(y);return l};/*! https://mths.be/utf8js v2.1.2 by @mathias */var x=String.fromCharCode;function R(e){for(var o=[],l=0,h=e.length,y,s;l<h;)y=e.charCodeAt(l++),y>=55296&&y<=56319&&l<h?(s=e.charCodeAt(l++),(s&64512)==56320?o.push(((y&1023)<<10)+(s&1023)+65536):(o.push(y),l--)):o.push(y);return o}function Y(e){for(var o=e.length,l=-1,h,y="";++l<o;)h=e[l],h>65535&&(h-=65536,y+=x(h>>>10&1023|55296),h=56320|h&1023),y+=x(h);return y}function q(e,o){if(e>=55296&&e<=57343){if(o)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function j(e,o){return x(e>>o&63|128)}function Z(e,o){if((e&4294967168)==0)return x(e);var l="";return(e&4294965248)==0?l=x(e>>6&31|192):(e&4294901760)==0?(q(e,o)||(e=65533),l=x(e>>12&15|224),l+=j(e,6)):(e&4292870144)==0&&(l=x(e>>18&7|240),l+=j(e,12),l+=j(e,6)),l+=x(e&63|128),l}function T(e,o){o=o||{};for(var l=o.strict!==!1,h=R(e),y=h.length,s=-1,S,P="";++s<y;)S=h[s],P+=Z(S,l);return P}function U(){if(b>=D)throw Error("Invalid byte index");var e=I[b]&255;if(b++,(e&192)==128)return e&63;throw Error("Invalid continuation byte")}function p(e){var o,l,h,y,s;if(b>D)throw Error("Invalid byte index");if(b==D)return!1;if(o=I[b]&255,b++,(o&128)==0)return o;if((o&224)==192){if(l=U(),s=(o&31)<<6|l,s>=128)return s;throw Error("Invalid continuation byte")}if((o&240)==224){if(l=U(),h=U(),s=(o&15)<<12|l<<6|h,s>=2048)return q(s,e)?s:65533;throw Error("Invalid continuation byte")}if((o&248)==240&&(l=U(),h=U(),y=U(),s=(o&7)<<18|l<<12|h<<6|y,s>=65536&&s<=1114111))return s;throw Error("Invalid UTF-8 detected")}var I,D,b;function k(e,o){o=o||{};var l=o.strict!==!1;I=R(e),D=I.length,b=0;for(var h=[],y;(y=p(l))!==!1;)h.push(y);return Y(h)}var rr={version:"2.1.2",encode:T,decode:k};(function(e){var o=X,l=V,h=W,y=G,s=rr,S;typeof ArrayBuffer<"u"&&(S=K());var P=typeof navigator<"u"&&/Android/i.test(navigator.userAgent),J=typeof navigator<"u"&&/PhantomJS/i.test(navigator.userAgent),L=P||J;e.protocol=3;var E=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},m=o(E),w={type:"error",data:"parser error"},A=M();e.encodePacket=function(r,f,t,n){typeof f=="function"&&(n=f,f=!1),typeof t=="function"&&(n=t,t=null);var a=r.data===void 0?void 0:r.data.buffer||r.data;if(typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer)return _(r,f,n);if(typeof A<"u"&&a instanceof A)return z(r,f,n);if(a&&a.base64)return N(r,n);var u=E[r.type];return r.data!==void 0&&(u+=t?s.encode(String(r.data),{strict:!1}):String(r.data)),n(""+u)};function N(r,f){var t="b"+e.packets[r.type]+r.data.data;return f(t)}function _(r,f,t){if(!f)return e.encodeBase64Packet(r,t);var n=r.data,a=new Uint8Array(n),u=new Uint8Array(1+n.byteLength);u[0]=E[r.type];for(var i=0;i<a.length;i++)u[i+1]=a[i];return t(u.buffer)}function $(r,f,t){if(!f)return e.encodeBase64Packet(r,t);var n=new FileReader;return n.onload=function(){e.encodePacket({type:r.type,data:n.result},f,!0,t)},n.readAsArrayBuffer(r.data)}function z(r,f,t){if(!f)return e.encodeBase64Packet(r,t);if(L)return $(r,f,t);var n=new Uint8Array(1);n[0]=E[r.type];var a=new A([n.buffer,r.data]);return t(a)}e.encodeBase64Packet=function(r,f){var t="b"+e.packets[r.type];if(typeof A<"u"&&r.data instanceof A){var n=new FileReader;return n.onload=function(){var v=n.result.split(",")[1];f(t+v)},n.readAsDataURL(r.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(r.data))}catch{for(var u=new Uint8Array(r.data),i=new Array(u.length),d=0;d<u.length;d++)i[d]=u[d];a=String.fromCharCode.apply(null,i)}return t+=btoa(a),f(t)},e.decodePacket=function(r,f,t){if(r===void 0)return w;if(typeof r=="string"){if(r.charAt(0)==="b")return e.decodeBase64Packet(r.substr(1),f);if(t&&(r=H(r),r===!1))return w;var a=r.charAt(0);return Number(a)!=a||!m[a]?w:r.length>1?{type:m[a],data:r.substring(1)}:{type:m[a]}}var n=new Uint8Array(r),a=n[0],u=h(r,1);return A&&f==="blob"&&(u=new A([u])),{type:m[a],data:u}};function H(r){try{r=s.decode(r,{strict:!1})}catch{return!1}return r}e.decodeBase64Packet=function(r,f){var t=m[r.charAt(0)];if(!S)return{type:t,data:{base64:!0,data:r.substr(1)}};var n=S.decode(r.substr(1));return f==="blob"&&A&&(n=new A([n])),{type:t,data:n}},e.encodePayload=function(r,f,t){typeof f=="function"&&(t=f,f=null);var n=l(r);if(f&&n)return A&&!L?e.encodePayloadAsBlob(r,t):e.encodePayloadAsArrayBuffer(r,t);if(!r.length)return t("0:");function a(i){return i.length+":"+i}function u(i,d){e.encodePacket(i,n?f:!1,!1,function(v){d(null,a(v))})}O(r,u,function(i,d){return t(d.join(""))})};function O(r,f,t){for(var n=new Array(r.length),a=y(r.length,t),u=function(d,v,F){f(v,function(c,g){n[d]=g,F(c,n)})},i=0;i<r.length;i++)u(i,r[i],a)}e.decodePayload=function(r,f,t){if(typeof r!="string")return e.decodePayloadAsBinary(r,f,t);typeof f=="function"&&(t=f,f=null);var n;if(r==="")return t(w,0,1);for(var a="",u,i,d=0,v=r.length;d<v;d++){var F=r.charAt(d);if(F!==":"){a+=F;continue}if(a===""||a!=(u=Number(a))||(i=r.substr(d+1,u),a!=i.length))return t(w,0,1);if(i.length){if(n=e.decodePacket(i,f,!1),w.type===n.type&&w.data===n.data)return t(w,0,1);var c=t(n,d+u,v);if(c===!1)return}d+=u,a=""}if(a!=="")return t(w,0,1)},e.encodePayloadAsArrayBuffer=function(r,f){if(!r.length)return f(new ArrayBuffer(0));function t(n,a){e.encodePacket(n,!0,!0,function(u){return a(null,u)})}O(r,t,function(n,a){var u=a.reduce(function(v,F){var c;return typeof F=="string"?c=F.length:c=F.byteLength,v+c.toString().length+c+2},0),i=new Uint8Array(u),d=0;return a.forEach(function(v){var F=typeof v=="string",c=v;if(F){for(var B=new Uint8Array(v.length),g=0;g<v.length;g++)B[g]=v.charCodeAt(g);c=B.buffer}F?i[d++]=0:i[d++]=1;for(var C=c.byteLength.toString(),g=0;g<C.length;g++)i[d++]=parseInt(C[g]);i[d++]=255;for(var B=new Uint8Array(c),g=0;g<B.length;g++)i[d++]=B[g]}),f(i.buffer)})},e.encodePayloadAsBlob=function(r,f){function t(n,a){e.encodePacket(n,!0,!0,function(u){var i=new Uint8Array(1);if(i[0]=1,typeof u=="string"){for(var d=new Uint8Array(u.length),v=0;v<u.length;v++)d[v]=u.charCodeAt(v);u=d.buffer,i[0]=0}for(var F=u instanceof ArrayBuffer?u.byteLength:u.size,c=F.toString(),g=new Uint8Array(c.length+1),v=0;v<c.length;v++)g[v]=parseInt(c[v]);if(g[c.length]=255,A){var C=new A([i.buffer,g.buffer,u]);a(null,C)}})}O(r,t,function(n,a){return f(new A(a))})},e.decodePayloadAsBinary=function(r,f,t){typeof f=="function"&&(t=f,f=null);for(var n=r,a=[];n.byteLength>0;){for(var u=new Uint8Array(n),i=u[0]===0,d="",v=1;u[v]!==255;v++){if(d.length>310)return t(w,0,1);d+=u[v]}n=h(n,2+d.length),d=parseInt(d);var F=h(n,0,d);if(i)try{F=String.fromCharCode.apply(null,new Uint8Array(F))}catch{var c=new Uint8Array(F);F="";for(var v=0;v<c.length;v++)F+=String.fromCharCode(c[v])}a.push(F),n=h(n,d)}var g=a.length;a.forEach(function(C,B){t(e.decodePacket(C,f,!0),B,g)})}})(Q);export{Q as b};
