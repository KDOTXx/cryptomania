import{D}from"./DashboardPageSidebar.7576c6ca.js";import{_ as w}from"./app.f6b791b5.js";import{e as i,f as o,F as u,v as a,i as h,s as g,j as p,C as v,D as l,g as y,Q as k,N as I,O as P,A as t,x as b}from"./@vue.ca773235.js";import"./overlayscrollbars.8d928870.js";import"./apexcharts.8dc8f2aa.js";import"./vue.9ea8e8a6.js";import"./vuex.497f08d2.js";import"./string-similarity.860833b6.js";import"./gsap.8449ad8c.js";import"./vue-router.63e2ccab.js";import"./vuex-persistedstate.fa252374.js";import"./izitoast.765d8918.js";import"./click-outside-vue3.6791b41e.js";import"./floating-vue.8db45bbf.js";import"./@floating-ui.9bdab495.js";import"./axios.ea6880df.js";import"./@vuepic.b319e7e5.js";import"./date-fns.5b6f9246.js";const A={props:["id"],data(){return{info:null}},created(){window.axios.post("/admin/checkDuplicates",{id:this.id}).then(({data:s})=>this.info=s)}},f=s=>(I("data-v-d544de40"),s=s(),P(),s),L={key:0,class:"fraud"},R={key:0,class:"f text-danger"},C={key:1,class:"f text-danger"},N={key:1,class:"f"},B={key:0,class:"f"},z=f(()=>t("div",{class:"text-danger"},"Same registration hash:",-1)),F={key:1,class:"f"},U=f(()=>t("div",{class:"text-danger"},"Same auth hash:",-1)),$={key:2,class:"f"},M=f(()=>t("div",{class:"text-danger"},"Same registration IP:",-1)),E={key:3,class:"f"},O=f(()=>t("div",{class:"text-danger"},"Same auth IP:",-1));function j(s,d,S,V,e,m){const c=k("router-link");return e.info?(i(),o("div",L,[!e.info.user.register_multiaccount_hash||!e.info.user.login_multiaccount_hash?(i(),o(u,{key:0},[e.info.user.register_multiaccount_hash?a("",!0):(i(),o("div",R,"Registered with clean cookies")),e.info.user.login_multiaccount_hash?a("",!0):(i(),o("div",C,"Authorized with clean cookies"))],64)):a("",!0),e.info.same_register_hash.length<=1&&e.info.same_login_hash.length<=1&&e.info.same_register_ip.length<=1&&e.info.same_login_ip.length<=1?(i(),o("div",N," - ")):(i(),o(u,{key:2},[e.info.same_register_hash.length>1&&e.info.user.register_multiaccount_hash?(i(),o("div",B,[z,(i(!0),o(u,null,h(e.info.same_register_hash,n=>(i(),g(c,{to:`/admin/user/${n._id}`,key:n},{default:p(()=>[v(l(n.name),1)]),_:2},1032,["to"]))),128))])):a("",!0),e.info.same_login_hash.length>1&&e.info.user.login_multiaccount_hash?(i(),o("div",F,[U,(i(!0),o(u,null,h(e.info.same_login_hash,n=>(i(),g(c,{to:`/admin/user/${n._id}`,key:n},{default:p(()=>[v(l(n.name),1)]),_:2},1032,["to"]))),128))])):a("",!0),e.info.same_register_ip.length>1?(i(),o("div",$,[M,(i(!0),o(u,null,h(e.info.same_register_ip,n=>(i(),o("div",{key:n},[y(c,{to:`/admin/user/${n._id}`},{default:p(()=>[v(l(n.name),1)]),_:2},1032,["to"])]))),128))])):a("",!0),e.info.same_register_ip.length>1?(i(),o("div",E,[O,(i(!0),o(u,null,h(e.info.same_login_ip,n=>(i(),o("div",{key:n},[y(c,{to:`/admin/user/${n._id}`},{default:p(()=>[v(l(n.name),1)]),_:2},1032,["to"])]))),128))])):a("",!0)],64))])):a("",!0)}const H=w(A,[["render",j],["__scopeId","data-v-d544de40"]]);const Q={data(){return{user:null,roles:null}},created(){this.$bus.$on("userSidebar:setData",s=>{this.user=s,this.$bus.$emit("sidebarLoading:done")}),this.$permission.checkPermission("*")&&window.axios.post("/admin/roles/all").then(({data:s})=>this.roles=s.roles)},methods:{setVIPLevel(){const s=prompt(`User won't be able to upgrade his VIP level naturally. One time bonus will be available.
Enter VIP level from 0 to 10 (-1 to revert the changes):`);if(s){let d=parseInt(s);if(d<-1||d>10)return alert("Invalid VIP level. Accepted: 0 - 10 or -1");window.axios.post("/admin/forceVip",{level:d,id:this.info.user._id}).then(()=>this.$toast.success("Success")).catch(()=>alert("Failed to set VIP level"))}},ban(s){this.user.user.ban=!this.user.user.ban,window.axios.post("/admin/ban",{id:s})},toggleRole(s){s==="*"&&this.user.user._id===s&&!confirm("Are you sure? You will remove super admin role (*) from yourself!")||window.axios.post("/admin/roles/toggleRole",{userId:this.user.user._id,roleId:s}).then(()=>{window.location.reload()})}},components:{MultiAccounts:H,DashboardPageSidebar:D}},_=s=>(I("data-v-97bef3ff"),s=s(),P(),s),T={class:"data"},Y=["src"],q={class:"category"},G=_(()=>t("div",{class:"title"},"Name History",-1)),J=_(()=>t("div",{class:"title"},"Info",-1)),K={class:"category"},W={class:"entry"},X=_(()=>t("div",null,"IP (Registered)",-1)),Z={class:"entry"},ee=_(()=>t("div",null,"IP (Authorized)",-1)),se={class:"entry"},te=_(()=>t("div",null,"Registered at",-1)),ie={class:"entry"},oe=_(()=>t("div",null,"Authorized at",-1)),ne=_(()=>t("div",{class:"title"},"Fraud Risk",-1)),re=_(()=>t("div",{class:"title"},"Roles",-1)),le=_(()=>t("option",{value:"-",disabled:"",selected:""},"...",-1)),ae=["value"],de={key:1,class:"title"},ue={style:{"margin-top":"10px"}};function _e(s,d,S,V,e,m){const c=k("multi-accounts"),n=k("dashboard-page-sidebar");return i(),g(n,{class:"userSidebar"},{default:p(()=>[e.user?(i(),o(u,{key:0},[t("div",T,[t("img",{src:e.user.user.avatar,alt:""},null,8,Y),v(" "+l(e.user.user.name),1)]),t("div",q,[G,(i(!0),o(u,null,h(e.user.user.name_history,r=>(i(),o("div",{class:"entry",key:r},[t("div",null,l(r.name),1),t("div",null,l(new Date(r.time).toLocaleString()),1)]))),128))]),J,t("div",K,[t("div",W,[t("div",null,l(e.user.user.register_ip),1),X]),t("div",Z,[t("div",null,l(e.user.user.register_ip),1),ee]),t("div",se,[t("div",null,l(new Date(e.user.user.created_at).toLocaleString()),1),te]),t("div",ie,[t("div",null,l(new Date(e.user.user.login_date).toLocaleString()),1),oe])]),ne,y(c,{id:e.user.user._id},null,8,["id"]),s.$permission.checkPermission("*")?(i(),o(u,{key:0},[re,t("select",{onChange:d[0]||(d[0]=r=>r.target.value==="-"?!1:m.toggleRole(r.target.value))},[le,(i(!0),o(u,null,h(e.roles,r=>(i(),o("option",{value:r.id,key:r},l(e.user.user.roles.filter(x=>x.id===r.id).length===0?"Add":"Remove")+" - "+l(r.name),9,ae))),128))],32)],64)):a("",!0),s.$permission.checkPermission("users","delete")||s.$permission.checkPermission("users","edit")?(i(),o("div",de,"Manage")):a("",!0),s.$permission.checkPermission("users","delete")?(i(),o(u,{key:2},[t("div",null,[t("button",{class:b([s.$isDemo?"demoDisable":"","btn btn-primary"]),onClick:d[1]||(d[1]=r=>m.ban(e.user.user._id))},l(e.user.user.ban?"Unban":"Ban"),3)]),t("div",ue,[s.$permission.checkPermission("users","edit")?(i(),o("button",{key:0,class:b(["btn btn-primary",s.$isDemo?"demoDisable":""]),onClick:d[2]||(d[2]=(...r)=>m.setVIPLevel&&m.setVIPLevel(...r))},"Set VIP level",2)):a("",!0)])],64)):a("",!0)],64)):a("",!0)]),_:1})}const Le=w(Q,[["render",_e],["__scopeId","data-v-97bef3ff"]]);export{Le as default};
