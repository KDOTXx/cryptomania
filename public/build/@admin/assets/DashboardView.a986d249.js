import{D as B}from"./DashboardWarning.95ccc3d6.js";import{m as M}from"./vuex.497f08d2.js";import{_,W as T}from"./app.f6b791b5.js";import{L as Y}from"./LoaderAnimation.f430cb8d.js";import{A as F}from"./apexcharts.8dc8f2aa.js";import{Q as c,e as s,f as o,F as g,D as y,v,A as i,s as m,g as p,j as L,I as w,a4 as $,C as f,i as W,a7 as E,N as R,O as z,a3 as J}from"./@vue.ca773235.js";import{D as H}from"./DashboardSpinner.225c547d.js";import"./vue.9ea8e8a6.js";import"./overlayscrollbars.8d928870.js";import"./string-similarity.860833b6.js";import"./gsap.8449ad8c.js";import"./vue-router.63e2ccab.js";import"./vuex-persistedstate.fa252374.js";import"./izitoast.765d8918.js";import"./click-outside-vue3.6791b41e.js";import"./floating-vue.8db45bbf.js";import"./@floating-ui.9bdab495.js";import"./axios.ea6880df.js";import"./@vuepic.b319e7e5.js";import"./date-fns.5b6f9246.js";const Q={props:["config"],data(){return{data:null,error:!1,noData:!1,chartData:null,isDemonstration:window.$isDemo||window.$forceRandomAnalytics}},created(){this.chartData={chart:{type:"line",height:"300px",width:"300px",background:"transparent",toolbar:{show:!1},zoom:{enabled:!1},sparkline:{enabled:!1},animations:{enabled:!1}},grid:{show:!1},theme:{mode:"dark"},colors:["#ea5454","#f4853f","#f9af4d","#9376bf","#8e45ad","#f27d7d","#2f4566"],legend:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},dataLabels:{enabled:!1},plotOptions:{pie:{expandOnClick:!1}}},this.config.chart&&(this.chartData=this.config.chart(this.chartData))},watch:{data(){var r;let a=[],n=[];if(this.data.forEach(h=>{let e=h.dimensions[this.config.dimension],l=h.metrics[this.config.metric];this.config.formatter&&this.config.formatter.dimension&&(e=this.config.formatter.dimension(e)),this.config.formatter&&this.config.formatter.metric&&(l=this.config.formatter.metric(l)),n.push(e),a.push(l)}),this.chartData.chart.type==="donut")this.chartData.series=a,this.chartData.labels=n;else if(this.chartData.chart.type==="line")this.chartData.xaxis.categories=n,this.chartData.series=[{name:(r=this.config.title)!=null?r:this.config.dimension+"-"+this.config.metric,data:a}];else throw new Error("Unknown chart type, can't configure labels/series "+this.chartData.chart.type);this.$nextTick(()=>{new F(this.$refs.chart,this.chartData).render()}),this.noData=this.data.length===0}},mounted(){if(this.isDemonstration){const a=[];for(let n=0;n<25;n++)a.push({dimensions:{[this.config.dimension]:this.config.dimension==="date"?"20220101":"*Demonstration*"},metrics:{[this.config.metric]:Math.floor(Math.random()*50)}});this.data=a}else window.axios.post(this.config.endpoint).then(({data:a})=>this.data=a).catch(()=>this.error=!0)},components:{WebIcon:T,LoaderAnimation:Y}},K={class:"block chart"},X={key:0,class:"title"},Z=i("div",{class:"content"}," No data available. ",-1),tt={key:0,class:"title"},et={key:1,class:"subtitle"},st={class:"content"},at={ref:"chart"},nt={key:0},it={key:0,class:"title"},ot=i("div",{class:"content"}," An error has occurred. ",-1),ct={key:4,class:"demo"},rt=i("div",{class:"description"},[i("div",null,"This chart is set to demonstration mode."),i("div",null,"All values are random.")],-1);function dt(a,n,r,h,e,l){const d=c("loader-animation"),t=c("web-icon");return s(),o("div",K,[e.noData?(s(),o(g,{key:0},[r.config.title?(s(),o("div",X,y(r.config.title),1)):v("",!0),Z],64)):e.data?(s(),o(g,{key:1},[r.config.title?(s(),o("div",tt,y(r.config.title),1)):v("",!0),r.config.subtitle?(s(),o("div",et,y(r.config.subtitle),1)):v("",!0),i("div",st,[i("div",at,null,512),r.config.debugData?(s(),o("div",nt,[i("pre",null,y(e.data),1)])):v("",!0)])],64)):e.error?(s(),o(g,{key:2},[r.config.title?(s(),o("div",it,y(r.config.title),1)):v("",!0),ot],64)):(s(),m(d,{key:3})),e.isDemonstration?(s(),o("div",ct,[p(t,{icon:"far fa-exclamation-triangle"}),rt])):v("",!0)])}const b=_(Q,[["render",dt]]),lt={components:{AnalyticsChart:b}};function mt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/pages",title:"Page",dimension:"pagePath",metric:"screenPageViews",formatter:{dimension:t=>"Page "+t,metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const ht=_(lt,[["render",mt]]),D=a=>{const n=new Date;return n.setFullYear(parseInt(a.substring(0,4)),parseInt(a.substring(4,6))-1,parseInt(a.substring(6,8))),n.toLocaleDateString()},pt={components:{AnalyticsChart:b},setup(){return{date:D}}};function ut(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/newUsers",title:"New Visits",dimension:"date",metric:"newUsers",formatter:{dimension:t=>h.date(t),metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{width:"350px"})})}},null,8,["config"])}const ft=_(pt,[["render",ut]]),_t={components:{AnalyticsChart:b},setup(){return{date:D}}};function gt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/totalUsers",title:"Visits",dimension:"date",metric:"totalUsers",formatter:{dimension:t=>h.date(t),metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{width:"350px"})})}},null,8,["config"])}const yt=_(_t,[["render",gt]]),vt={components:{AnalyticsChart:b}};function bt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/popularDeviceTypes",title:"Device Type",dimension:"deviceCategory",metric:"totalUsers",formatter:{metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const wt=_(vt,[["render",bt]]),kt={components:{AnalyticsChart:b}};function xt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/popularBrowsers",title:"Browser",dimension:"browser",metric:"totalUsers",formatter:{metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const It=_(kt,[["render",xt]]),Dt={components:{AnalyticsChart:b}};function $t(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/popularOS",title:"Operating System",dimension:"operatingSystem",metric:"totalUsers",formatter:{metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const Tt=_(Dt,[["render",$t]]),qt={components:{AnalyticsChart:b}};function At(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/country",title:"Country",dimension:"country",metric:"totalUsers",formatter:{metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const Ot=_(qt,[["render",At]]),Ut={components:{AnalyticsChart:b}};function jt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/city",title:"City",dimension:"city",metric:"totalUsers",formatter:{metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const St=_(Ut,[["render",jt]]),Ct={components:{AnalyticsChart:b}};function Pt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/region",title:"Region",dimension:"region",metric:"totalUsers",formatter:{metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{type:"donut"}),stroke:{show:!1}})}},null,8,["config"])}const Gt=_(Ct,[["render",Pt]]),Nt={components:{AnalyticsChart:b},setup(){return{date:D}}};function Vt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/registeredUsers",title:"Registered Users",dimension:"date",metric:"totalUsers",formatter:{dimension:t=>h.date(t),metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{width:"350px"})})}},null,8,["config"])}const Bt=_(Nt,[["render",Vt]]),Mt={components:{AnalyticsChart:b},props:["game"],setup(){return{date:D}}};function Yt(a,n,r,h,e,l){const d=c("analytics-chart");return s(),m(d,{config:{endpoint:"/admin/stats/game/"+r.game.id,title:r.game.name,subtitle:r.game.id,dimension:"date",metric:"totalUsers",formatter:{dimension:t=>h.date(t),metric:t=>parseInt(t)},chart:t=>Object.assign(t,{chart:Object.assign(t.chart,{width:"350px"})})}},null,8,["config"])}const Ft=_(Mt,[["render",Yt]]);const Lt={data(){return{validation:null,file:null,propertyId:"",streamId:"",measurementId:"",registeredUsers:null,gamesTotal:null,invoicesTotal:null,balance:null,maintenance:null,analyticsType:"general"}},created(){this.license?window.axios.post("/admin/stats/validate").then(({data:a})=>{this.validation=a,this.$bus.$emit("loading:done"),a.isConfigured&&(window.axios.post("/admin/stats/registeredUsersTotal").then(({data:n})=>this.registeredUsers=n),window.axios.post("/admin/stats/gamesTotal").then(({data:n})=>this.gamesTotal=n),window.axios.post("/admin/stats/invoicesTotal").then(({data:n})=>this.invoicesTotal=n),window.axios.post("/admin/stats/totalWalletBalance").then(({data:n})=>this.balance=n),this.$permission.checkPermission("*")&&window.axios.post("/admin/maintenance/status").then(({data:n})=>this.maintenance=n.status))}):window.location.href="/"},computed:{...M(["license","games"])},methods:{toggleMaintenance(){this.maintenance=!this.maintenance,window.$isDemo||window.axios.post("/admin/maintenance/toggle")},done(){let a=new FormData;a.append("file",this.file),a.append("propertyId",this.propertyId),a.append("streamId",this.streamId),a.append("measurementId",this.measurementId),window.axios.post("/admin/stats/configure",a).then(()=>{window.location.reload()}).catch(()=>this.$toast.error("Failed to authorize using these credentials. If you believe that the information you've provided is correct, try again after a few minutes - sometimes there might be a delay in Google servers."))},upload(){const a=document.createElement("input");a.type="file",a.onchange=()=>{this.file=a.files[0]},a.click()}},components:{DashboardSpinner:H,RegisteredUsersAnalytics:Bt,RegionAnalytics:Gt,CityAnalytics:St,CountryAnalytics:Ot,OperationSystemAnalytics:Tt,PopularBrowsersAnalytics:It,PopularDeviceTypesAnalytics:wt,TotalUsersAnalytics:yt,NewUsersAnalytics:ft,WebIcon:T,DashboardWarning:B,PagesAnalytics:ht,GameAnalytics:Ft}},k=a=>(R("data-v-34f9c12d"),a=a(),z(),a),Wt={class:"index animate"},Et=E('<div class="step" data-v-34f9c12d><div class="number" data-v-34f9c12d>1</div><div class="content" data-v-34f9c12d><div class="title" data-v-34f9c12d>Getting credentials</div><div class="text" data-v-34f9c12d><div data-v-34f9c12d> The first thing you\u2019ll need to do is to get some credentials to use Google API\u2019s. You should already have created Google account and be signed in. Head over to <a href="https://console.developers.google.com/apis" target="_blank" data-v-34f9c12d>Google API\u2019s site</a> and click &quot;Select a project&quot; in the header. </div><img src="/img/dashboard/analytics/guide-1.png" data-v-34f9c12d><div data-v-34f9c12d> Next up we must specify which API\u2019s the project may consume. In the list of API Library find &quot;Google Analytics Data API&quot;. On the next screen click &quot;Enable&quot;. </div><div class="mt" data-v-34f9c12d> Now that you\u2019ve created a project that has access to the Analytics API it\u2019s time to download a file with these credentials. Click &quot;Credentials&quot; in the sidebar. You\u2019ll want to create a &quot;Service account key&quot;. </div><img src="/img/dashboard/analytics/guide-3.png" data-v-34f9c12d><div data-v-34f9c12d> On the next screen you can give the service account a name. You can name it anything you\u2019d like. In the service account id you\u2019ll see an email address. We\u2019ll use this email address later on in this guide. </div><img src="/img/dashboard/analytics/guide-4.png" data-v-34f9c12d><div data-v-34f9c12d> Select &quot;JSON&quot; as the key type and click &quot;Create&quot; to download the JSON file. </div><img src="/img/dashboard/analytics/guide-5.png" data-v-34f9c12d><div data-v-34f9c12d> Save the json somewhere on your computer. You&#39;ll need it later. </div></div></div></div><div class="step" data-v-34f9c12d><div class="number" data-v-34f9c12d>2</div><div class="content" data-v-34f9c12d><div class="title" data-v-34f9c12d>Granting permissions to your Analytics property</div><div class="text" data-v-34f9c12d><div data-v-34f9c12d> You should have already created a Google Analytics 4 account on the <a href="https://analytics.google.com/analytics" target="_blank" data-v-34f9c12d>Analytics site</a>. </div><div class="mt" data-v-34f9c12d> Go to &quot;User management&quot; in the Admin-section of the property. </div><img src="/img/dashboard/analytics/guide-7.png" data-v-34f9c12d><div data-v-34f9c12d> On this screen you can grant access to the email address found in the &quot;client_email&quot; key from the json file you download in the previous step. Analyst role is enough. </div><img src="/img/dashboard/analytics/guide-8.png" data-v-34f9c12d></div></div></div><div class="step" data-v-34f9c12d><div class="number" data-v-34f9c12d>3</div><div class="content" data-v-34f9c12d><div class="title" data-v-34f9c12d>Getting the measurement and stream id</div><div class="text" data-v-34f9c12d><div data-v-34f9c12d> You can get the right value on the <a href="https://analytics.google.com/analytics" target="_blank" data-v-34f9c12d>Analytics site</a>. </div><div class="mt" data-v-34f9c12d> Go to &quot;Settings&quot;, click on &quot;Property Settings&quot; and copy the &quot;Property ID&quot;. </div><div class="mt" data-v-34f9c12d> Go to &quot;Settings&quot;, click on &quot;Data Streams&quot; and create &quot;Web&quot; data stream. Click on the created data stream and copy the &quot;Measurement ID&quot; and &quot;Stream ID&quot;. </div></div></div></div>',3),Rt={class:"step"},zt=k(()=>i("div",{class:"number"},"4",-1)),Jt={class:"content"},Ht=k(()=>i("div",{class:"title"},"Configure dashboard",-1)),Qt={class:"text"},Kt=k(()=>i("div",null,"Upload the downloaded .json file and enter the obtained ids.",-1)),Xt={class:"mt"},Zt={class:"mt"},te={class:"mt"},ee={class:"fileUpload mt"},se={key:0,style:{"margin-left":"10px"}},ae=["disabled"],ne={key:1,class:"block-container wrap"},ie={class:"basicStats"},oe={class:"stat"},ce=k(()=>i("div",{class:"name"},"Users",-1)),re={class:"number"},de={key:0,class:"stat"},le=k(()=>i("div",{class:"name"},"Balance",-1)),me={class:"number"},he=k(()=>i("div",{class:"name"},"Games",-1)),pe={class:"number"},ue={class:"stat yellow"},fe=k(()=>i("div",{class:"name"},"Deposits",-1)),_e={class:"number"},ge=k(()=>i("div",{class:"name"},"Maintenance",-1)),ye={class:"number"};function ve(a,n,r,h,e,l){c("router-link");const d=c("dashboard-warning"),t=c("web-icon"),I=c("dashboard-spinner"),q=c("total-users-analytics"),A=c("new-users-analytics"),O=c("registered-users-analytics"),U=c("pages-analytics"),j=c("popular-device-types-analytics"),S=c("popular-browsers-analytics"),C=c("operation-system-analytics"),P=c("region-analytics"),G=c("country-analytics"),N=c("city-analytics"),V=c("game-analytics"),x=J("tooltip");return s(),o("div",Wt,[e.validation?(s(),o(g,{key:1},[e.validation.isConfigured?(s(),o("div",ne,[i("div",ie,[i("div",oe,[p(t,{icon:"fal fa-users fa-fw"}),ce,i("div",re,[e.registeredUsers?(s(),o(g,{key:1},[w((s(),o("div",null,[f(y(e.registeredUsers.today),1)])),[[x,"Today"]]),f(" / "),w((s(),o("div",null,[f(y(e.registeredUsers.count),1)])),[[x,"Total"]])],64)):(s(),m(I,{key:0}))])]),a.$permission.checkPermission("wallet")?(s(),o("div",de,[p(t,{icon:"fal fa-wallet fa-fw"}),le,i("div",me,[e.balance?(s(),o(g,{key:1},[f(" $"+y(e.balance.balance.toFixed(2)),1)],64)):(s(),m(I,{key:0}))])])):v("",!0),i("div",{class:"stat blue clickable",onClick:n[5]||(n[5]=u=>e.analyticsType=e.analyticsType==="general"?"games":"general")},[p(t,{icon:"fal fa-dice-d20 fa-fw"}),he,i("div",pe,[e.gamesTotal?(s(),o(g,{key:1},[w((s(),o("div",null,[f(y(e.gamesTotal.today),1)])),[[x,"Today"]]),f(" / "),w((s(),o("div",null,[f(y(e.gamesTotal.count),1)])),[[x,"Total"]]),p(t,{icon:"fal fa-chevron-right"})],64)):(s(),m(I,{key:0}))])]),i("div",ue,[p(t,{icon:"fal fa-arrow-down fa-fw"}),fe,i("div",_e,[e.invoicesTotal?(s(),o(g,{key:1},[w((s(),o("div",null,[f(y(e.invoicesTotal.today),1)])),[[x,"Today"]]),f(" / "),w((s(),o("div",null,[f(y(e.invoicesTotal.count),1)])),[[x,"Total"]])],64)):(s(),m(I,{key:0}))])]),a.$permission.checkPermission("*")?(s(),o("div",{key:1,class:"stat red clickable",onClick:n[6]||(n[6]=(...u)=>l.toggleMaintenance&&l.toggleMaintenance(...u))},[p(t,{icon:"fal fa-tools fa-fw"}),ge,i("div",ye,[e.maintenance===null?(s(),m(I,{key:0})):(s(),m(t,{key:1,icon:e.maintenance?"fal fa-fw fa-check":"fal fa-fw fa-times"},null,8,["icon"]))])])):v("",!0)]),e.analyticsType==="general"?(s(),o(g,{key:0},[p(q),p(A),p(O),p(U),p(j),p(S),p(C),p(P),p(G),p(N)],64)):e.analyticsType==="games"?(s(!0),o(g,{key:1},W(a.games,u=>(s(),m(V,{game:u,key:u.id+u.type},null,8,["game"]))),128)):v("",!0)])):(s(),o(g,{key:0},[a.$permission.checkPermission("*")?(s(),o(g,{key:1},[Et,i("div",Rt,[zt,i("div",Jt,[Ht,i("div",Qt,[Kt,i("div",Xt,[w(i("input",{placeholder:"Property ID","onUpdate:modelValue":n[0]||(n[0]=u=>e.propertyId=u),type:"text"},null,512),[[$,e.propertyId]])]),i("div",Zt,[w(i("input",{placeholder:"Measurement ID","onUpdate:modelValue":n[1]||(n[1]=u=>e.measurementId=u),type:"text"},null,512),[[$,e.measurementId]])]),i("div",te,[w(i("input",{placeholder:"Stream ID","onUpdate:modelValue":n[2]||(n[2]=u=>e.streamId=u),type:"text"},null,512),[[$,e.streamId]])]),i("div",ee,[i("button",{class:"btn btn-primary",onClick:n[3]||(n[3]=(...u)=>l.upload&&l.upload(...u))},[p(t,{icon:"fal fa-fw fa-upload"}),f(" Upload .json")]),e.file?(s(),o("div",se,"Uploaded")):v("",!0)])])])]),i("button",{class:"btn btn-primary",disabled:e.file===null||e.streamId.length<2||e.measurementId.length<2||e.propertyId.length<2,onClick:n[4]||(n[4]=(...u)=>l.done&&l.done(...u))},[p(t,{icon:"fal fa-fw fa-check"}),f(" Done")],8,ae)],64)):(s(),m(d,{key:0,type:"warning"},{default:L(()=>[f(" Statistics are not configured. Contact your system administration. ")]),_:1}))],64))],64)):v("",!0)])}const Me=_(Lt,[["render",ve],["__scopeId","data-v-34f9c12d"]]);export{Me as default};
