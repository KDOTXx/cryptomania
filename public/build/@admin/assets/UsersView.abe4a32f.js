import{_ as h,W as v}from"./app.f6b791b5.js";import{z as g}from"./zipcelx.266ed464.js";import{O as y}from"./overlayscrollbars.8d928870.js";import{f as o,A as r,g as m,I as x,a4 as f,v as p,F as c,i as _,D as a,e as l,C as w,N as k,O as b,Q as C}from"./@vue.ca773235.js";import"./vue.9ea8e8a6.js";import"./vuex.497f08d2.js";import"./string-similarity.860833b6.js";import"./gsap.8449ad8c.js";import"./vue-router.63e2ccab.js";import"./vuex-persistedstate.fa252374.js";import"./izitoast.765d8918.js";import"./apexcharts.8dc8f2aa.js";import"./click-outside-vue3.6791b41e.js";import"./floating-vue.8db45bbf.js";import"./@floating-ui.9bdab495.js";import"./axios.ea6880df.js";import"./@vuepic.b319e7e5.js";import"./date-fns.5b6f9246.js";import"./lodash.escape.bfda3e94.js";import"./jszip.40028396.js";import"./file-saver.accb2fd9.js";const P={data(){return{users:null,page:1,search:"",loadedOnce:!1,maxPages:null}},watch:{page(){this.load()},search(){let s=Math.random();if(window.$usersR=s,this.search.length===0){this.users=null,this.page=1,this.load();return}this.page=1,this.users=null,window.axios.post("/admin/searchUsers",{search:this.search}).then(({data:e})=>{window.$usersR===s&&(this.users={users:e})})}},mounted(){y(document.querySelector(".users .entries"),{scrollbars:{autoHide:"leave"},className:"os-theme-thin-light"})},methods:{jump(){const s=parseInt(prompt(`Enter page (from 1 to ${this.maxPages}):`));s&&!isNaN(s)&&s>=1&&s<=this.maxPages?this.page=s:alert("Invalid page: "+s)},load(){window.axios.post("/admin/users/"+this.page).then(({data:s})=>{this.loadedOnce||(this.$bus.$emit("loading:done"),this.loadedOnce=!0),this.users===null&&(this.users=[]),this.users=s,this.maxPages=s.maxPages})},exportXLSX(){try{let s={filename:"user-list-exported"+(this.search.length===0?"":"-"+this.search.replaceAll(" ","-")),sheet:{data:[[{value:"Username",type:"string"},{value:"Email",type:"string"},{value:"VIP level",type:"string"},{value:"Deposited ($)",type:"string"},{value:"Withdrawn ($)",type:"string"},{value:"Registered",type:"string"}]]}};this.users.forEach(e=>{let n=[];n.push({value:e.name,type:"string"}),n.push({value:e.email,type:"string"}),n.push({value:e.vipLevel,type:"number"}),n.push({value:e.depositedTotal.toFixed(2),type:"string"}),n.push({value:e.withdrawnUsdTotal.toFixed(2),type:"string"}),n.push({value:new Date(e.created_at).toLocaleString(),type:"string"}),s.sheet.data.push(n)}),g(s)}catch{this.$toast.error("Failed to export")}}},created(){this.load()},components:{WebIcon:v}},S=s=>(k("data-v-34550e2a"),s=s(),b(),s),I={class:"users"},L={class:"animate"},N={key:0,class:"search"},V={class:"entries"},F=S(()=>r("div",{class:"h"},[r("div",null,"Name"),r("div",null,"Email"),r("div",null,"VIP Level"),r("div",null,"Deposited"),r("div",null,"Withdrawn"),r("div",null,"Registered")],-1)),U=["onClick"],D=["src"],O={key:1,class:"pagination"},E={class:"current"};function T(s,e,n,X,t,d){const u=C("web-icon");return l(),o("div",I,[r("div",L,[t.loadedOnce?(l(),o("div",N,[m(u,{icon:"fal fa-fw fa-search"}),x(r("input",{type:"text",placeholder:"Filter","onUpdate:modelValue":e[0]||(e[0]=i=>t.search=i)},null,512),[[f,t.search]]),r("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...i)=>d.exportXLSX&&d.exportXLSX(...i))},"Export as .xlsx"),s.$permission.checkPermission("users","create")?(l(),o("button",{key:0,class:"btn btn-primary",onClick:e[2]||(e[2]=i=>s.$router.push("/admin/createUser"))},"Create")):p("",!0)])):p("",!0),r("div",V,[t.users?(l(),o(c,{key:0},[F,(l(!0),o(c,null,_(t.users.users,i=>(l(),o("div",{class:"entry",key:i._id,onClick:j=>s.$router.push("/admin/user/"+i._id)},[r("div",null,[r("img",{alt:"",src:i.avatar},null,8,D),w(" "+a(i.name),1)]),r("div",null,a(i.email),1),r("div",null,a(i.vipLevel),1),r("div",null," $"+a(i.depositedTotal.toFixed(2)),1),r("div",null," $"+a(i.withdrawnUsdTotal.toFixed(2)),1),r("div",null,a(new Date(i.created_at).toLocaleString()),1)],8,U))),128))],64)):p("",!0)]),t.maxPages?(l(),o("div",O,[t.page-2>=1?(l(),o("div",{key:0,class:"prev",onClick:e[3]||(e[3]=i=>t.page-=2)},a(t.page-2),1)):p("",!0),t.page-1>=1?(l(),o("div",{key:1,class:"prev",onClick:e[4]||(e[4]=i=>t.page--)},a(t.page-1),1)):p("",!0),r("div",E,a(t.page),1),t.page+1<=t.maxPages?(l(),o("div",{key:2,class:"next",onClick:e[5]||(e[5]=i=>t.page++)},a(t.page+1),1)):p("",!0),t.page+2<=t.maxPages?(l(),o("div",{key:3,class:"next",onClick:e[6]||(e[6]=i=>t.page+=2)},a(t.page+2),1)):p("",!0),r("div",{class:"jump",onClick:e[7]||(e[7]=(...i)=>d.jump&&d.jump(...i))},[m(u,{icon:"fal fa-fw fa-ellipsis-h"})])])):p("",!0)])])}const ae=h(P,[["render",T],["__scopeId","data-v-34550e2a"]]);export{ae as default};
