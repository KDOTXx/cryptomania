import{l as i}from"./lodash.escape.bfda3e94.js";import{J as c}from"./jszip.40028396.js";import{F as p}from"./file-saver.accb2fd9.js";const a="string",h="number",f=[a,h],x="Zipclex config missing property filename",d="Zipclex filename can only be of type string",v="Zipcelx sheet data is not of type array",y="Zipclex sheet data childs is not of type array",u='Invalid type supplied in cell config, falling back to "string"',k=e=>e.every(t=>Array.isArray(t));var g=e=>e.filename?typeof e.filename!="string"?(console.error(d),!1):Array.isArray(e.sheet.data)?k(e.sheet.data)?!0:(console.error(y),!1):(console.error(v),!1):(console.error(x),!1);const m=e=>{if(typeof e!="number")return"";const t=Math.floor(e/26),o=String.fromCharCode(97+e%26).toUpperCase();return t===0?o:m(t-1)+o};var n=(e,t)=>`${m(e)}${t}`,w=(e,t,o)=>`<c r="${n(e,o)}" t="inlineStr"><is><t>${i(t)}</t></is></c>`,T=(e,t,o)=>`<c r="${n(e,o)}"><v>${t}</v></c>`,E=(e,t,o)=>(f.indexOf(e.type)===-1&&(console.warn(u),e.type=a),e.type===a?w(t,e.value,o):T(t,e.value,o)),b=(e,t)=>{const o=t+1,s=e.map((r,l)=>E(r,l,o)).join("");return`<row r="${o}">${s}</row>`},I=e=>e.map((t,o)=>b(t,o)).join(""),_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mx="http://schemas.microsoft.com/office/mac/excel/2008/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:xm="http://schemas.microsoft.com/office/excel/2006/main"><workbookPr/><sheets><sheet state="visible" name="Sheet1" sheetId="1" r:id="rId3"/></sheets><definedNames/><calcPr/></workbook>`,C=`<?xml version="1.0" ?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
<Relationship Id="rId3" Target="worksheets/sheet1.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"/>
</Relationships>`,N=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>`,A=`<?xml version="1.0" ?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
<Default ContentType="application/xml" Extension="xml"/>
<Default ContentType="application/vnd.openxmlformats-package.relationships+xml" Extension="rels"/>
<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" PartName="/xl/worksheets/sheet1.xml"/>
<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" PartName="/xl/workbook.xml"/>
</Types>`,L=`<?xml version="1.0" ?>
<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:mx="http://schemas.microsoft.com/office/mac/excel/2008/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:xm="http://schemas.microsoft.com/office/excel/2006/main"><sheetData>{placeholder}</sheetData></worksheet>`;const D=e=>{const t=I(e);return L.replace("{placeholder}",t)};var M=e=>{if(!g(e))throw new Error("Validation failed.");const t=new c,o=t.folder("xl");o.file("workbook.xml",_),o.file("_rels/workbook.xml.rels",C),t.file("_rels/.rels",N),t.file("[Content_Types].xml",A);const s=D(e.sheet.data);return o.file("worksheets/sheet1.xml",s),t.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}).then(r=>{p.saveAs(r,`${e.filename}.xlsx`)})};export{M as z};
